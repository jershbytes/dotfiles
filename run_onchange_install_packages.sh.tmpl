{{ if eq .chezmoi.os "linux" -}}
#!/bin/bash

# Ensure system is up to date
echo "Updating system packages..."
sudo pacman -Syu --noconfirm

# Install official packages from pacman
echo "Installing official packages..."
sudo pacman -S --noconfirm {{ range .pacman }}{{ . }} {{ end }}

# Install paru if not present (AUR helper)
if ! command -v paru &> /dev/null; then
    echo "Installing paru..."
    git clone https://aur.archlinux.org/paru.git
    cd paru
    makepkg -si --noconfirm
    cd ..
    rm -rf paru
fi

# Install AUR packages using paru
echo "Installing AUR packages..."
{{ range .aur -}}
if ! command -v {{ . }} &> /dev/null; then
    paru -S --noconfirm {{ . }}
fi
{{ end }}

echo "Package installation completed!"
{{ end -}}