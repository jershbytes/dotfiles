# Disable auto-update
DISABLE_AUTO_UPDATE="true"

# Load Homebrew
eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

# Defer plugin loading
OMZ_LAZY_LOAD=true

# fpath setup (before plugins)
fpath+=${ZSH_CUSTOM:-${ZSH:-~/.oh-my-zsh}/custom}/plugins/zsh-completions/src

# --- load plugins
plugins=(
aliases ansible archlinux brew bun chezmoi colored-man-pages copyfile copypath docker docker-compose fzf genpass git gitignore history macos
nvm opentofu pip starship sudo systemd ubuntu uv vscode zoxide zsh-autosuggestions zsh-interactive-cd
)

# --- Oh My Zsh Core Initialization
source $ZSH/oh-my-zsh.sh

# Load custom files
for file in ~/.zsh/*.zsh; do
  source "$file" 2>/dev/null
done
unset file

# Lazy-load completions (cached)
autoload -Uz compinit

if [[ -f ${ZDOTDIR:-~}/.zcompdump ]]; then
    if [[ $(find ${ZDOTDIR:-~}/.zcompdump -mtime -1 2>/dev/null) ]]; then
        # Cache is less than 24 hours old
        compinit -C
    else
        # Cache is older than 24 hours
        compinit
    fi
else
    # No cache exists yet
    compinit
fi

# Completion settings
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'